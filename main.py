from GolfWorld.GolfWorldMDP import GolfWorldMDP
from simple_rl.run_experiments import run_agents_on_mdp
from simple_rl.agents import QLearningAgent, DoubleQAgent, RandomAgent

# the hole is upside down and flipped, but it doesn't really matter
# 0 represents fairway/green
# 1 represents rough
# 2 represents hazard
# 3 represents the tee
# 4 represents the hole
hole_1 = [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,1,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,0,1,1,1,1,1,2,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,0,0,0,1,1,1,1],
          [1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,1,1,1],
          [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,1,1,1],
          [1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,2,1,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,2,1,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,1,2,2,2,0,0,2,1,0,0,0,1,1,1,1],
          [1,1,0,0,0,0,0,0,0,0,0,1,2,2,0,4,0,2,1,1,1,1,1,1,1,1],
          [1,1,0,0,0,0,0,1,1,1,1,1,2,2,0,0,2,2,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,2,1,1,1,1,1,1,1,1,1],
          [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]

rough_locs = []
hazard_locs = []

for i, row in enumerate(hole_1):
    for j, elem in enumerate(row):
        if elem == 1:
            rough_locs.append((i,j))
        elif elem == 2:
            hazard_locs.append((i,j))
        elif elem == 3:
            tee_loc = (i,j)
        elif elem == 4:
            hole_loc = (i,j)

mdp = GolfWorldMDP(width=len(hole_1), height=len(hole_1[0]),
                               tee_loc=tee_loc, hole_loc=hole_loc, rough_locs = rough_locs, hazard_locs=hazard_locs,
                               wind_dir="right",wind_spd=4,
                               gamma=0.99,step_cost=0.01,name="hole_1")

ql_agent = QLearningAgent(actions=mdp.get_actions())
q2_agent = DoubleQAgent(actions=mdp.get_actions())
rand_agent = RandomAgent(actions=mdp.get_actions())


run_agents_on_mdp([ql_agent, q2_agent, rand_agent], mdp, instances=10, episodes=150, steps=100)
